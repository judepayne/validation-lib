# Business Configuration (Tier 2)
# Business logic config - owned by rules team
# Defines rulesets, rules, and schema mappings

# Base URI for fetching logic files (rules, models, helpers) from remote source.
# Validation-lib uses this to construct full URLs for each file it needs.
# Omit (or comment out) to load from relative local paths (development mode).
logic_base_uri: "https://raw.githubusercontent.com/judepayne/validation-logic/main"

# Rulesets - validation rule sets with metadata
# Rules are assigned per schema version for version-specific validation
rulesets:
  quick:
    metadata:
      description: "Essential validation checks for real-time inline validation"
      purpose: "Use during loan origination to catch critical errors before submission"
      author: "Data Quality Team"
      date: "2026-02-18"
    rules:
      "https://raw.githubusercontent.com/judepayne/validation-logic/main/models/loan.schema.v1.0.0.json":
        - rule_id: rule_001_v1  # JSON schema validation
        - rule_id: rule_002_v1  # Financial soundness checks
      "https://raw.githubusercontent.com/judepayne/validation-logic/main/models/loan.schema.v2.0.0.json":
        - rule_id: rule_001_v1  # JSON schema validation (v2 schema)
        - rule_id: rule_002_v1  # Financial soundness checks
      # Backward compatibility fallback for tests without $schema
      loan:
        - rule_id: rule_001_v1  # JSON schema validation
        - rule_id: rule_002_v1  # Financial soundness checks
      facility: []
      deal: []

  thorough:
    metadata:
      description: "Comprehensive validation checks for complete data quality assurance"
      purpose: "Use for batch processing and final validation before data publication"
      author: "Data Quality Team"
      date: "2026-02-18"
    rules:
      "https://raw.githubusercontent.com/judepayne/validation-logic/main/models/loan.schema.v1.0.0.json":
        - rule_id: rule_001_v1  # JSON schema validation
        - rule_id: rule_002_v1  # Financial soundness checks
        - rule_id: rule_003_v1  # Status validation
          children:
            - rule_id: rule_004_v1  # Balance validation (depends on valid status)
      "https://raw.githubusercontent.com/judepayne/validation-logic/main/models/loan.schema.v2.0.0.json":
        - rule_id: rule_001_v1  # JSON schema validation (v2 schema)
        - rule_id: rule_002_v1  # Financial soundness checks
        - rule_id: rule_003_v1  # Status validation
          children:
            - rule_id: rule_004_v1  # Balance validation (depends on valid status)
      # Backward compatibility fallback for tests without $schema
      loan:
        - rule_id: rule_001_v1  # JSON schema validation
        - rule_id: rule_002_v1  # Financial soundness checks
        - rule_id: rule_003_v1  # Status validation
          children:
            - rule_id: rule_004_v1  # Balance validation (depends on valid status)
      facility: []
      deal: []

# Schema URL to entity helper class mapping
# Keys match the $id values in the schema files (raw GitHub URLs)
schema_to_helper_mapping:
  "https://raw.githubusercontent.com/judepayne/validation-logic/main/models/loan.schema.v1.0.0.json": "loan_v1.LoanV1"
  "https://raw.githubusercontent.com/judepayne/validation-logic/main/models/loan.schema.v2.0.0.json": "loan_v2.LoanV2"

# Default helper when no $schema field is present
default_helpers:
  loan: "loan_v1.LoanV1"
  # facility: "facility_v1.FacilityV1"  # TODO: Implement
  # deal: "deal_v1.DealV1"              # TODO: Implement

# Version compatibility settings
version_compatibility:
  allow_minor_version_fallback: true
  strict_major_version: true
